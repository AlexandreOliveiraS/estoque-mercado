<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>Estoque</title>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
  <h1 class="mb-3">Controle de Estoque</h1>

  <div th:if="${alerts != null and !#lists.isEmpty(alerts)}" class="alert alert-warning">
    Atenção: há produtos no mínimo.
  </div>

  <div class="card mb-4">
    <div class="card-header">Novo Produto</div>
    <div class="card-body">
      <form th:action="@{/products}" th:object="${product}" method="post" class="row g-3">
        <div class="col-md-3">
          <label class="form-label">Nome</label>
          <input class="form-control" th:field="*{name}" required />
        </div>
        <div class="col-md-3">
          <label class="form-label">Código de Barras</label>
          <input class="form-control" th:field="*{barcode}" required />
        </div>
        <div class="col-md-2">
          <label class="form-label">Qtd Inicial</label>
          <input type="number" class="form-control" th:field="*{quantity}" value="0" min="0" />
        </div>
        <div class="col-md-2">
          <label class="form-label">Mínimo</label>
          <input type="number" class="form-control" th:field="*{minQuantity}" value="0" min="0" />
        </div>
        <div class="col-md-2">
          <label class="form-label">Preço</label>
          <input type="number" step="0.01" class="form-control" th:field="*{price}" value="0.00" />
        </div>
        <div class="col-12">
          <button class="btn btn-primary">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Nome</th><th>Cód. Barras</th><th>Qtd</th><th>Mín.</th><th>Preço</th><th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="p : ${products}">
        <td th:text="${p.name} ?: '—'">Nome</td>
        <td th:text="${p.barcode} ?: '—'">123</td>
        <td th:text="${p.quantity} ?: 0">0</td>
        <td th:text="${p.minQuantity} ?: 0">0</td>
        <td th:text="${p.price} ?: 0.00">0.00</td>
        <td>
          <form th:action="@{|/products/${p.id}/entrada|}" method="post" class="d-inline">
            <input type="number" name="qtd" class="form-control d-inline w-auto" value="1" min="1" />
            <button class="btn btn-success btn-sm">Entrada</button>
          </form>
          <form th:action="@{|/products/${p.id}/saida|}" method="post" class="d-inline ms-2">
            <input type="number" name="qtd" class="form-control d-inline w-auto" value="1" min="1" />
            <button class="btn btn-danger btn-sm">Saída</button>
          </form>
        </td>
      </tr>
    </tbody>
  </table>
</body>
</html>
